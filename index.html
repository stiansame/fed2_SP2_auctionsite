<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Browse and bid on student auction listings." />
    <title>Noroff Auctionsite | Home</title>

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Poppins:wght@500;600;700&display=swap" rel="stylesheet" />

    <link rel="stylesheet" href="./css/style.css" />
    <link rel="icon" href="data:," />
    <script type="module" src="./js/app.js"></script>
</head>

<body>
    <a href="#main" class="sr-only focus:not-sr-only focus:absolute focus:top-3 focus:left-3 focus:z-50 focus:rounded-md focus:bg-white focus:px-3 focus:py-2 focus:shadow">
        Skip to content
    </a>

    <header id="site-header" class="site-header"></header>

    <main id="main" class="container-page py-6">
        <!-- HOME VIEW -->
        <div id="homeView">
            <section class="mb-6">
                <div class="flex flex-col gap-2 sm:flex-row sm:items-end sm:justify-between">
                    <div>
                        <h1>Live listings</h1>
                        <p>Browse auctions, view bids, and log in to place your own bids.</p>
                    </div>
                </div>
            </section>

            <section class="mb-6 card card-pad">
                <form id="searchForm" class="grid gap-3 md:grid-cols-12 md:items-end" autocomplete="off">
                    <div class="md:col-span-6">
                        <label for="searchInput">Search listings</label>
                        <div class="mt-1 flex gap-2">
                            <input id="searchInput" name="q" type="search" placeholder="Try “camera”, “bike”, “vintage”…" />
                            <button type="submit" class="btn-primary">Search</button>
                        </div>
                        <small>Guests can browse and search. Log in to bid.</small>
                    </div>

                    <div class="md:col-span-3">
                        <label for="sortSelect">Sort</label>
                        <select id="sortSelect" name="sort">
                            <option value="created_desc" selected>Newest</option>
                            <option value="ends_asc">Ending soon</option>
                            <option value="bids_desc">Most bids</option>
                        </select>
                    </div>

                    <div class="md:col-span-3">
                        <label for="statusSelect">Status</label>
                        <select id="statusSelect" name="status">
                            <!-- Default: Active only -->
                            <option value="all">All</option>
                            <option value="active" selected>Active only</option>
                            <option value="ended">Ended</option>
                        </select>
                    </div>
                </form>
            </section>

            <section id="feedback" class="mb-6 hidden alert-danger">
                <div class="flex items-start justify-between gap-4">
                    <p id="feedbackText" class="text-red-900">Something went wrong.</p>
                    <button id="feedbackDismiss" type="button" class="btn-secondary">Dismiss</button>
                </div>
            </section>

            <section aria-label="Listings">
                <div id="listingsLoading" class="grid gap-4 sm:grid-cols-2 lg:grid-cols-3">
                    <div class="card card-pad animate-pulse">
                        <div class="h-32 rounded-lg bg-slate-200"></div>
                        <div class="mt-4 h-4 w-3/4 rounded bg-slate-200"></div>
                        <div class="mt-2 h-4 w-1/2 rounded bg-slate-200"></div>
                    </div>
                    <div class="card card-pad animate-pulse">
                        <div class="h-32 rounded-lg bg-slate-200"></div>
                        <div class="mt-4 h-4 w-3/4 rounded bg-slate-200"></div>
                        <div class="mt-2 h-4 w-1/2 rounded bg-slate-200"></div>
                    </div>
                    <div class="hidden lg:block card card-pad animate-pulse">
                        <div class="h-32 rounded-lg bg-slate-200"></div>
                        <div class="mt-4 h-4 w-3/4 rounded bg-slate-200"></div>
                        <div class="mt-2 h-4 w-1/2 rounded bg-slate-200"></div>
                    </div>
                </div>

                <div id="listingsGrid" class="hidden grid gap-4 sm:grid-cols-2 lg:grid-cols-3"></div>

                <!-- Load more button for 15-at-a-time pagination -->
                <button id="loadMoreBtn" class="btn-secondary mt-6 w-full hidden" type="button">
                    Load more
                </button>

                <div id="listingsEmpty" class="hidden card card-pad text-center">
                    <h2>No listings found</h2>
                    <p>Try a different search or clear filters.</p>
                    <div class="mt-4 flex justify-center gap-2">
                        <button id="clearSearchBtn" type="button" class="btn-secondary">Clear search</button>
                        <a href="#/create" class="btn-primary">Create listing</a>
                    </div>
                </div>
            </section>

            <!-- Old pagination section (optional, unused) -->
            <section id="pagination" class="mt-8 hidden items-center justify-between">
                <button id="prevPageBtn" class="btn-secondary" disabled>← Previous</button>
                <p class="text-sm text-brand-muted">Page <span id="pageNumber">1</span></p>
                <button id="nextPageBtn" class="btn-secondary" disabled>Next →</button>
            </section>
        </div>

        <!-- APP VIEW (routed pages render here) -->
        <div id="appView" class="hidden"></div>
    </main>

    <footer class="border-t bg-white">
        <div class="container-page py-6 text-sm text-brand-muted">
            Built for the Noroff Auction API — front-end only.
        </div>
    </footer>

    <!-- Toast container -->
    <div id="toastRoot" class="fixed z-50 flex flex-col gap-2 pointer-events-none
         inset-x-0 top-4 px-4 items-center
         sm:inset-auto sm:top-4 sm:right-4 sm:items-end"></div>

    <!-- Back to top button -->
    <button id="backToTopBtn" class="hidden fixed bottom-6 right-4 btn-secondary px-3 py-2 text-sm shadow-lg">
        ↑ Back to top
    </button>

    <script>
        (function () {
            const btn = document.getElementById("feedbackDismiss");
            const box = document.getElementById("feedback");
            if (btn && box) btn.addEventListener("click", () => box.classList.add("hidden"));
        })();
    </script>

</body>

</html>